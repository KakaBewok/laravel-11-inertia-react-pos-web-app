import{j as e,y as p}from"./app-BmY1Do-R.js";import{B as u}from"./button-CoCtyn1R.js";import{P as C,a as E,C as P,b as S,c as T}from"./popover-DJPIfLZ8.js";import{o as _,s as b,f as A,g as B,u as H,t as I,F as L,a as d,b as c,c as m,d as l,e as x,T as M}from"./index-DAbcSfye.js";import{H as G}from"./heading-DRkXQex5.js";import{I as f}from"./input-DLUMN1d1.js";import{u as R}from"./useGlobalContext-DEDc1K2H.js";import{c as V}from"./utils-CcFn7B-c.js";import{B as $}from"./react-toastify.esm-DQOW_WDH.js";import{f as q}from"./format-BEMO4FpZ.js";import"./index-BG4KsFYa.js";import"./createLucideIcon-2Xt1I0At.js";import"./react-icons.esm-CDMxvkF1.js";import"./index-i5Cu2bn0.js";import"./index-CgiO58h2.js";import"./index-B_3iuKlB.js";import"./index-DU0AJar9.js";import"./index-xZEHp8pJ.js";import"./index-B2fOyC-2.js";import"./clsx-B-dksMZM.js";const z=_({name:b().min(3,{message:"Category must contain at least 3 character(s)"}),amount:A.number().min(0,{message:"Minimal amount is 0"}),description:b().optional(),expense_date:B().refine(s=>{const t=new Date;t.setHours(0,0,0,0);const a=new Date(t);return a.setDate(t.getDate()+1),s<a},{message:"The expense date cannot be tomorrow or in the future."})}),le=({initialData:s})=>{const{loading:t,setLoading:a}=R(),k=s?"Edit expense":"Create expense",y=s?"Edit an expense":"Add a new expense",N=s?"Expense updated.":"Expense created.",F=s?"Save changes":"Create",n=H({resolver:I(z),defaultValues:{name:(s==null?void 0:s.name)||"",amount:(s==null?void 0:s.amount)||0,description:(s==null?void 0:s.description)||"",expense_date:(s==null?void 0:s.expense_date)||new Date}}),v=r=>{a(!0),console.log(r);const o=()=>{n.reset()},g=()=>{o(),p.visit(route("admin.expense.index")),setTimeout(()=>{$.success(N,{position:"top-center"})},1e3)},h=w=>{console.log("An error occurred: ",w)},j=()=>a(!1),i=r.expense_date.toLocaleDateString("en-CA");s?p.post(route("admin.expense.update",s==null?void 0:s.id),{...r,expense_date:i,_method:"PATCH"},{onSuccess:g,onError:h,onFinish:j}):p.post(route("admin.expense.store"),{...r,expense_date:i},{onSuccess:g,onError:h,onFinish:j})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between pb-5",children:[e.jsx(G,{title:k,description:y}),e.jsx(u,{variant:"outline",onClick:()=>window.history.back(),className:"dark:bg-slate-200 dark:text-slate-900",children:"Back"})]}),e.jsx(L,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(v),className:"w-full p-8 space-y-8 rounded-md bg-slate-50 dark:bg-gradient-to-tr md:dark:bg-gradient-to-br dark:from-slate-950 dark:via-slate-900 dark:to-slate-800",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:gap-8 md:grid-cols-2",children:[e.jsx(d,{control:n.control,name:"name",render:({field:r,fieldState:o})=>e.jsxs(c,{children:[e.jsx(m,{className:o.error?"text-red-500":"dark:text-gray-300",children:"Name"}),e.jsx(l,{children:e.jsx(f,{className:"dark:bg-slate-700",disabled:t,placeholder:"Paying taxes",...r})}),e.jsx(x,{className:"dark:text-red-500"})]})}),e.jsx(d,{control:n.control,name:"amount",render:({field:r,fieldState:o})=>e.jsxs(c,{children:[e.jsx(m,{className:o.error?"text-red-500":"dark:text-gray-300",children:"Amount"}),e.jsx(l,{children:e.jsx(f,{className:"dark:bg-slate-700",type:"number",disabled:t,...r})}),e.jsx(x,{className:"dark:text-red-500"})]})}),e.jsx(d,{control:n.control,name:"description",render:({field:r,fieldState:o})=>e.jsxs(c,{children:[e.jsx(m,{className:o.error?"text-red-500":"dark:text-gray-300",children:"Description"}),e.jsx(l,{children:e.jsx(M,{className:"w-full h-32 max-w-lg max-h-40 dark:bg-slate-700",disabled:t,placeholder:"Describe about paying taxes.",...r})}),e.jsx(x,{className:"dark:text-red-500"})]})}),e.jsx(d,{control:n.control,name:"expense_date",render:({field:r,fieldState:o})=>e.jsxs(c,{children:[e.jsx(m,{className:o.error?"text-red-500":"dark:text-gray-300",children:"Expense Date"}),e.jsx(l,{children:e.jsxs(C,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:V("w-full justify-start gap-3 p-5 text-left font-normal dark:bg-slate-600 dark:hover:bg-slate-600",!r.value&&"text-muted-foreground"),children:[e.jsx(P,{}),r.value?q(r.value,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(S,{className:"w-auto p-0",children:e.jsx(T,{mode:"single",selected:r.value,onSelect:r.onChange,initialFocus:!0})})]})}),e.jsx(x,{className:"dark:text-red-500"})]})})]}),e.jsx(u,{disabled:t,className:"w-full lg:w-1/2",type:"submit",children:F})]})})]})};export{le as ExpenseForm};
