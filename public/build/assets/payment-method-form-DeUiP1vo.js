import{r as l,j as e,y as T}from"./app-Dyg4hIRD.js";import{B as L}from"./button-BGlJ2IqG.js";import{o as te,s as I,l as ne,i as H,j as U,u as ce,t as ae,F as le,a as C,b as N,c as F,d as y,e as P,k as Q}from"./index-CONTUHxp.js";import{H as de}from"./heading-BPhm2l3T.js";import{I as E}from"./input-BSGOrdT3.js";import{u as me,c as ue}from"./index-MKkQDYT1.js";import{u as ie}from"./index-BAbzBGZy.js";import{u as he,S as O,a as z,b as K,c as G,d as w}from"./select-D3vnuwlW.js";import{u as pe}from"./index-B2Z6DjDO.js";import{P as Y}from"./index-DJbXlp5f.js";import{c as X}from"./utils-CcFn7B-c.js";import{u as xe}from"./useGlobalContext-SHRvv1E1.js";import{u as ge}from"./file-utils-CdlLiblU.js";import{B as fe}from"./react-toastify.esm-BX7HF12G.js";import{A as W,M as B,B as be}from"./constants-JGxeO3yw.js";import"./react-icons.esm-JRe5vi4w.js";import"./index-Bq5v8EPX.js";import"./index-DJFI9dwZ.js";import"./clsx-B-dksMZM.js";function je(s,i=[]){let o=[];function g(u,c){const a=l.createContext(c),h=o.length;o=[...o,c];const p=f=>{var j;const{scope:x,children:S,...v}=f,t=((j=x==null?void 0:x[s])==null?void 0:j[h])||a,_=l.useMemo(()=>v,Object.values(v));return e.jsx(t.Provider,{value:_,children:S})};p.displayName=u+"Provider";function k(f,x){var t;const S=((t=x==null?void 0:x[s])==null?void 0:t[h])||a,v=l.useContext(S);if(v)return v;if(c!==void 0)return c;throw new Error(`\`${f}\` must be used within \`${u}\``)}return[p,k]}const d=()=>{const u=o.map(c=>l.createContext(c));return function(a){const h=(a==null?void 0:a[s])||u;return l.useMemo(()=>({[`__scope${s}`]:{...a,[s]:h}}),[a,h])}};return d.scopeName=s,[g,ke(d,...i)]}function ke(...s){const i=s[0];if(s.length===1)return i;const o=()=>{const g=s.map(d=>({useScope:d(),scopeName:d.scopeName}));return function(u){const c=g.reduce((a,{useScope:h,scopeName:p})=>{const f=h(u)[`__scope${p}`];return{...a,...f}},{});return l.useMemo(()=>({[`__scope${i.scopeName}`]:c}),[c])}};return o.scopeName=i.scopeName,o}var $="Switch",[ve,Ke]=je($),[ye,we]=ve($),Z=l.forwardRef((s,i)=>{const{__scopeSwitch:o,name:g,checked:d,defaultChecked:u,required:c,disabled:a,value:h="on",onCheckedChange:p,form:k,...f}=s,[x,S]=l.useState(null),v=ie(i,r=>S(r)),t=l.useRef(!1),_=x?k||!!x.closest("form"):!0,[j=!1,M]=me({prop:d,defaultProp:u,onChange:p});return e.jsxs(ye,{scope:o,checked:j,disabled:a,children:[e.jsx(Y.button,{type:"button",role:"switch","aria-checked":j,"aria-required":c,"data-state":ee(j),"data-disabled":a?"":void 0,disabled:a,value:h,...f,ref:v,onClick:ue(s.onClick,r=>{M(n=>!n),_&&(t.current=r.isPropagationStopped(),t.current||r.stopPropagation())})}),_&&e.jsx(Se,{control:x,bubbles:!t.current,name:g,value:h,checked:j,required:c,disabled:a,form:k,style:{transform:"translateX(-100%)"}})]})});Z.displayName=$;var J="SwitchThumb",D=l.forwardRef((s,i)=>{const{__scopeSwitch:o,...g}=s,d=we(J,o);return e.jsx(Y.span,{"data-state":ee(d.checked),"data-disabled":d.disabled?"":void 0,...g,ref:i})});D.displayName=J;var Se=s=>{const{control:i,checked:o,bubbles:g=!0,...d}=s,u=l.useRef(null),c=he(o),a=pe(i);return l.useEffect(()=>{const h=u.current,p=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(p,"checked").set;if(c!==o&&f){const x=new Event("click",{bubbles:g});f.call(h,o),h.dispatchEvent(x)}},[c,o,g]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o,...d,tabIndex:-1,ref:u,style:{...s.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function ee(s){return s?"checked":"unchecked"}var se=Z,_e=D;const re=l.forwardRef(({className:s,...i},o)=>e.jsx(se,{className:X("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50","dark:data-[state=checked]:bg-slate-50 data-[state=checked]:bg-slate-800 data-[state=unchecked]:bg-input","dark:bg-slate-600",s),...i,ref:o,children:e.jsx(_e,{className:X("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));re.displayName=se.displayName;const Ce=te({name:I().min(3,{message:"Name must contain at least 3 character(s)"}),bank_name:I().optional(),status:ne({required_error:"Status is required",invalid_type_error:"Status must be a boolean"}),account_number:I().optional(),account_holder:I().optional(),bank_logo:H([U(File).refine(s=>W.includes(s.type),{message:"Bank logo must be jpg, jpeg, png or webp formats"}).refine(s=>s.size<=B*1024,{message:`Bank logo is more than ${B}KB`}),I()]).optional(),qris_image:H([U(File).refine(s=>W.includes(s.type),{message:"QRIS Image must be jpg, jpeg, png or webp formats"}).refine(s=>s.size<=B*1024,{message:`QRIS Image is more than ${B}KB`}),I()]).optional()}),Ge=({initialData:s})=>{const[i,o]=l.useState(),[g,d]=l.useState(),u=l.useRef(null),c=l.useRef(null),[a,h]=l.useState(!1),{loading:p,setLoading:k}=xe(),f=s?"Edit payment method":"Create payment method",x=s?"Edit a payment method":"Add a new payment method",S=s?"Payment method updated.":"Payment method created.",v=s?"Save changes":"Create",t=ce({resolver:ae(Ce),defaultValues:{name:(s==null?void 0:s.name)||"",bank_name:(s==null?void 0:s.bank_name)||"",account_number:(s==null?void 0:s.account_number)||"",account_holder:(s==null?void 0:s.account_holder)||"",status:(s==null?void 0:s.status)||!1,bank_logo:s==null?void 0:s.bank_logo,qris_image:s==null?void 0:s.qris_image}});l.useEffect(()=>{(async()=>{var m;const n=[{key:"bank_logo",ref:u,setFile:o},{key:"qris_image",ref:c,setFile:d}];if(s!=null&&s.bank_logo||s!=null&&s.qris_image)for(const b of n){const R=s==null?void 0:s[b.key];if(R){const q=Math.floor(Math.random()*9e4)+1e4,oe=`${be}/storage/${R}`,A=await ge(oe,`${b.key}-${q}.jpg`,"image/jpeg");b.setFile(A);const V=new DataTransfer;V.items.add(A),(m=b.ref)!=null&&m.current&&(b.ref.current.files=V.files),t.setValue(b.key,A)}}})()},[s,t]);const _=(r,n)=>{if(r.target.files&&r.target.files.length){const m=r.target.files[0];n==="bank_logo"?(o(m),t.setValue("bank_logo",m)):n==="qris_image"&&(d(m),t.setValue("qris_image",m))}},j=r=>{const m=[{key:"bank_logo",ref:u,setFile:o},{key:"qris_image",ref:c,setFile:d}].find(b=>b.key===r);m&&(m!=null&&m.ref.current)&&(m.setFile(void 0),m.ref.current.value="",t.setValue(m.key,void 0))},M=r=>{k(!0);const n=()=>{t.reset(),o(void 0),d(void 0),u.current&&c.current&&(u.current.value="",c.current.value="")},m=()=>{n(),a?T.visit(route("admin.payment_method.create")):T.visit(route("admin.payment_method.index")),setTimeout(()=>{fe.success(S,{position:"top-center"})},1e3)},b=q=>{console.log("An error occurred: ",q)},R=()=>k(!1);s?T.post(route("admin.payment_method.update",s==null?void 0:s.id),{...r,_method:"PATCH"},{onSuccess:m,onError:b,onFinish:R}):T.post(route("admin.payment_method.store"),r,{onSuccess:m,onError:b,onFinish:R})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(de,{title:f,description:x}),e.jsx(L,{variant:"outline",onClick:()=>window.history.back(),className:"dark:bg-slate-200 dark:text-slate-900",children:"Back"})]}),e.jsx(le,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(M),className:"w-full p-8 space-y-8 rounded-md bg-slate-50 dark:bg-gradient-to-tr md:dark:bg-gradient-to-br dark:from-slate-950 dark:via-slate-900 dark:to-slate-800",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:gap-8 md:grid-cols-2",children:[e.jsx(C,{control:t.control,name:"name",render:({field:r,fieldState:n})=>e.jsxs(N,{children:[e.jsxs(F,{className:n.error?"text-red-500":"dark:text-gray-300",children:["Payment Method",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(y,{children:e.jsxs(O,{disabled:p,onValueChange:r.onChange,value:r.value,children:[e.jsx(y,{className:"dark:bg-slate-700",children:e.jsx(z,{className:"w-full",children:e.jsx(K,{defaultValue:r.value,placeholder:"Select a payment method"})})}),e.jsxs(G,{children:[e.jsx(w,{value:"Bank Transfer",children:"Bank Transfer"}),e.jsx(w,{value:"QRIS",children:"QRIS"}),e.jsx(w,{value:"Cash",children:"Cash"})]})]})}),e.jsx(P,{className:"dark:text-red-500"})]})}),e.jsx(C,{control:t.control,name:"bank_name",render:({field:r,fieldState:n})=>e.jsxs(N,{children:[e.jsx(F,{className:n.error?"text-red-500":"dark:text-gray-300",children:"Bank Name"}),e.jsx(y,{children:e.jsxs(O,{disabled:p,onValueChange:r.onChange,value:r.value,children:[e.jsx(y,{className:"dark:bg-slate-700",children:e.jsx(z,{className:"w-full",children:e.jsx(K,{defaultValue:r.value,placeholder:"Select a bank name"})})}),e.jsxs(G,{children:[e.jsx(w,{value:"BCA",children:"BCA"}),e.jsx(w,{value:"BRI",children:"BRI"}),e.jsx(w,{value:"BSI",children:"BSI"}),e.jsx(w,{value:"BNI",children:"BNI"}),e.jsx(w,{value:"Mandiri",children:"Mandiri"}),e.jsx(w,{value:"Permata",children:"Permata"})]})]})}),e.jsx(P,{className:"dark:text-red-500"})]})}),e.jsx(C,{control:t.control,name:"account_number",render:({field:r,fieldState:n})=>e.jsxs(N,{children:[e.jsx(F,{className:n.error?"text-red-500":"dark:text-gray-300",children:"Account Number"}),e.jsx(y,{children:e.jsx(E,{className:"dark:bg-slate-700",disabled:p,type:"number",placeholder:"1330013617493",...r})}),e.jsx(P,{className:"dark:text-red-500"})]})}),e.jsx(C,{control:t.control,name:"account_holder",render:({field:r,fieldState:n})=>e.jsxs(N,{children:[e.jsx(F,{className:n.error?"text-red-500":"dark:text-gray-300",children:"Account Holder"}),e.jsx(y,{children:e.jsx(E,{className:"dark:bg-slate-700",disabled:p,placeholder:"PT Mencari Cinta Sejati",...r})}),e.jsx(P,{className:"dark:text-red-500"})]})}),e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsx(C,{control:t.control,name:"bank_logo",render:({fieldState:r})=>e.jsxs(N,{children:[e.jsx(F,{className:r.error?"text-red-500":"dark:text-gray-300",children:"Bank Logo"}),e.jsx(y,{children:e.jsx(E,{className:"w-full md:w-[48%] dark:bg-slate-700",ref:u,type:"file",accept:"image/jpeg, image/png, image/jpg, image/webp",onChange:n=>_(n,"bank_logo")})}),e.jsxs(Q,{children:["Max. ",B,"KB (jpg, jpeg, png, webp only)."]}),e.jsx(P,{className:"dark:text-red-500"})]})}),i&&e.jsxs("div",{className:"relative overflow-hidden border rounded-md shadow-md dark:border-gray-200 border-slate-300 w-52 h-52",children:[e.jsx("img",{src:URL.createObjectURL(i),alt:"Bank logo uploaded",className:"object-cover w-full h-full"}),e.jsx("button",{className:"absolute flex items-center justify-center w-6 h-6 text-white bg-red-500 rounded-full top-2 right-2",type:"button",onClick:()=>j("bank_logo"),children:e.jsx("span",{className:"text-xs leading-none",children:"✕"})})]})]}),e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsx(C,{control:t.control,name:"qris_image",render:({fieldState:r})=>e.jsxs(N,{children:[e.jsx(F,{className:r.error?"text-red-500":"dark:text-gray-300",children:"QRIS image"}),e.jsx(y,{children:e.jsx(E,{className:"w-full md:w-[48%] dark:bg-slate-700",ref:c,type:"file",accept:"image/jpeg, image/png, image/jpg, image/webp",onChange:n=>_(n,"qris_image")})}),e.jsxs(Q,{children:["Max. ",B,"KB (jpg, jpeg, png, webp only)."]}),e.jsx(P,{className:"dark:text-red-500"})]})}),g&&e.jsxs("div",{className:"relative overflow-hidden border rounded-md shadow-md dark:border-gray-200 border-slate-300 w-52 h-52",children:[e.jsx("img",{src:URL.createObjectURL(g),alt:"QRIS image uploaded",className:"object-cover w-full h-full"}),e.jsx("button",{className:"absolute flex items-center justify-center w-6 h-6 text-white bg-red-500 rounded-full top-2 right-2",type:"button",onClick:()=>j("qris_image"),children:e.jsx("span",{className:"text-xs leading-none",children:"✕"})})]})]}),e.jsx(C,{control:t.control,name:"status",render:({field:r,fieldState:n})=>e.jsxs(N,{children:[e.jsx(F,{className:n.error?"text-red-500":"dark:text-gray-300",children:"Active"}),e.jsx(y,{children:e.jsx("div",{children:e.jsx(re,{checked:r.value,onCheckedChange:r.onChange,disabled:p,"aria-readonly":!0})})}),e.jsx(P,{className:"dark:text-red-500"})]})})]}),e.jsxs("div",{className:"flex flex-col items-center justify-between w-full gap-4 mt-10 md:w-1/2 lg:flex-row",children:[e.jsx(L,{disabled:p,className:"w-full",type:"submit",onClick:()=>h(!1),children:v}),e.jsx(L,{disabled:p,className:`${s?"hidden":""} w-full bg-slate-300 text-slate-950 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-200`,type:"submit",onClick:()=>h(!0),children:"Create & Create another"})]})]})})]})};export{Ge as PaymentMethodForm};
